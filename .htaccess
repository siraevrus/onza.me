# Защита файла базы данных от прямого доступа
<Files "database.db">
    Order Allow,Deny
    Deny from all
</Files>

# Для Apache - перенаправление несуществующих файлов проектов и услуг
RewriteEngine On

# Директории projects и services - используем index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} -d
RewriteCond %{REQUEST_URI} ^/(projects|services)/?$ [NC]
RewriteRule ^(.*)$ $1/index.php [L]

# Если файл не существует и это похоже на проект в папке projects/, проверяем БД
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^/projects/(project-|opharme) [NC]
RewriteRule ^projects/(.*)$ project_handler.php?file=$1 [L,QSA]

# Если файл не существует и это услуга в папке services/, проверяем БД
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^/services/(.+)\.php$ [NC]
RewriteRule ^services/(.*)$ service_handler.php?file=$1 [L,QSA]
